<!-- Profile Image Crop Modal -->
<ng-template #profileImageCropModal>
  <div class="modal-header border-0">
    <button type="button" class="close pull-right text-white" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">

    <!-- Image Cropper -->
    <image-cropper [imageChangedEvent]="imageChangedEvent" [maintainAspectRatio]="true" [aspectRatio]="4 / 4"
      [resizeToWidth]="128" format="png" (imageCropped)="imageCropped($event)" (imageLoaded)="imageLoaded()"
      (cropperReady)="cropperReady()" (loadImageFailed)="loadImageFailed()"></image-cropper>

    <!-- Show Cropped Image Here -->
    <div class="profile-img-container mt-5">
      <img *ngIf="croppedImage" class="d-block mx-auto" [src]="croppedImage.url">
    </div>

    <button type="button" class="btn btn-info" (click)="upadateProfileImage()">Save</button>
  </div>
</ng-template>

<div class="p-section container">
  <div class="dashboard-content">
    <h2 class="text-center topHeading">My Profile
    </h2>
    <div class="row">
      <div class="col-md-12">
        <button routerLink="/assessment/dashboard/" class="btn float-left btnLeaderboard"><i
            class="fas fa-angle-double-left mr-1"></i>Dashboard</button>
      </div>
      <div class="col-md-12">
        <hr>
      </div>
    </div>
    <div class="row d-flex ">
      <div class="col-md-10">
        <div class="row">
          <div class="col-lg-4">

            <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
              <a class="nav-link" id="" data-toggle="" href="javascript:void(0)" routerLink="/assessment/dashboard"
                role="tab" aria-controls="" aria-selected="true"><span class="iconify"
                  data-icon="dashicons:admin-home"></span> Dashboard</a>
              <a class="nav-link active" id="v-pills-home-tab" data-toggle="pill" href="#v-pills-home" role="tab"
                aria-controls="v-pills-home" aria-selected="true"><span class="iconify"
                  data-icon="carbon:user-avatar-filled-alt"></span> Account Details</a>
              <a class="nav-link" id="v-pills-profile-tab" data-toggle="pill" href="#v-pills-profile" role="tab"
                aria-controls="v-pills-profile" aria-selected="false"><span class="iconify"
                  data-icon="simple-icons:googledomains"></span> Exam(s) Interested</a>
              <a class="nav-link" id="v-pills-messages-tab" data-toggle="pill" href="#v-pills-messages" role="tab"
                aria-controls="v-pills-messages" aria-selected="false"><span class="iconify"
                  data-icon="ri:lock-password-fill"></span> Change Password</a>
              <a *ngIf="invitation?.length > 0" class="nav-link" id="v-pills-invitation-tab" data-toggle="pill"
                href="#v-pills-invitation" role="tab" aria-controls="v-pills-invitation" aria-selected="false"><span
                  class="iconify" data-icon="ri:lock-password-fill"></span> School Invitation</a>
              <a class="nav-link" id="" data-toggle="modal" data-target="#confirmationModalLogOut" href="" role="tab"
                aria-controls="" aria-selected="false"><span class="iconify" data-icon="mdi:logout"></span> Logout</a>
            </div>
          </div>
          <div class="col-lg-7 offset-lg-1">
            <div class="tab-content" id="v-pills-tabContent">
              <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel"
                aria-labelledby="v-pills-home-tab">
                <div class="row mb-4">
                  <div class="col-md-4">
                    <div class="profile-img-container position-relative">
                      <img src="{{ userImage ? userImage : env.DEFAULT_USER_PROFILE}}" alt="User Profile"
                        class="user-img">
                    </div>
                  </div>
                  <div class="col-md-6 d-flex align-items-center">
                    <div class="row">
                      <div class="col-md-12">
                        <div class="customFileInputNew" (click)="changeUserProfile(imageInput)">
                          <button class="btn btnChangeProfile">Change Profile</button>
                          <!-- <img src="assets/images/editProfile.png" alt=""> -->
                          <div *ngIf="userProfileObj" class="mt-4 text-center">
                          </div>
                          <input type="file" id="profilepic" (change)="upadateProfileImage()" class="inputfile"
                            name="userImage" #imageInput>
                        </div>
                      </div>
                      <div class="col-md-12">
                        <h6 class="formatInst">Accepting the file format jpg, png <br> and max size is 50 kb.</h6>
                      </div>
                    </div>

                    <!-- <div class="row">
                      <div class="col-md-12">
                        <p>Accepting the file format jpg, png. and max size is 50 kb.</p>
                      </div>
                    </div> -->
                  </div>
                </div>
                <div class="changePasswordDiv profileEditForm col-lg-12 ">
                  <form [formGroup]="profileForm" (submit)="onSubmit()">

                    <div class="form-group row">
                      <label for="inputPassword" class="col-sm-4 col-form-label">Name</label>
                      <div class="col-sm-8">
                        <input type="text" class="form-control" formControlName="fullname" id="inputPassword"
                          placeholder="Enter your full name">
                      </div>
                    </div>


                    <div class="form-group row">
                      <label for="inputPassword" class="col-sm-4 col-form-label">Mobile</label>
                      <div class="col-sm-8">
                        <label for="inputPassword" style=" font-size: 14px;border: 1px solid rgba(0, 0, 0, 0.48); border-radius: 5px;
                          color: #5a5a5a; background: #F9F9F9;width: 100%;height: 35px;padding: 0.375rem 0.75rem;"
                          class="col-form-label">{{contactNumber}}</label>
                      </div>
                    </div>


                    <div class="form-group row">
                      <label for="inputPassword" class="col-sm-4 col-form-label">Email</label>
                      <div class="col-sm-8">
                        <input type="email" formControlName="email" class="form-control" id="inputPassword"
                          placeholder="Enter your email id">
                      </div>
                    </div>

                    <div class="form-group row">
                      <label for="inputPassword" class="col-sm-4 col-form-label">Gender </label>
                      <div class="col-sm-8">
                        <select class="form-control" id="sel2" formControlName="gender">
                          <option value="">Select Gender</option>
                          <option value="male">Male</option>
                          <option value="female">Female</option>
                          <option value="other">Other</option>
                        </select>
                      </div>
                    </div>

                    <div class="form-group row">
                      <label for="inputPassword" class="col-sm-4 col-form-label">State/UT </label>
                      <div class="col-sm-8">
                        <select class="form-control" id="sel2" formControlName="state"
                          (change)="fetchStateCities($event.target.value)">
                          <option value="">Select State</option>
                          <option [value]="state?.id" *ngFor="let state of states; let i = index">{{state?.name}}
                          </option>
                        </select>
                      </div>
                    </div>


                    <div class="form-group row">
                      <label for="inputPassword" class="col-sm-4 col-form-label">City </label>
                      <div class="col-sm-8">
                        <select class="form-control" id="sel2" formControlName="city">
                          <option value="">Select City</option>
                          <option [value]="city?.id" *ngFor="let city of cities; let i = index">{{city?.name}}</option>
                        </select>
                      </div>
                    </div>


                    <div class="form-group row">
                      <label for="inputPassword" class="col-sm-4 col-form-label">Qualification </label>
                      <div class="col-sm-8">
                        <select class="form-control" id="sel2" formControlName="qualification">
                          <option value="">Select Qualification</option>
                          <option value="10th">10th</option>
                          <option value="12th">12th</option>
                          <option value="graduation">Graduate</option>
                          <option value="postgraduation">Post Graduate</option>
                          <option value="other">Other</option>
                        </select>
                      </div>
                    </div>


                    <!-- <div class="card">
                      <div class="form-group row">
                        <label for="inputPassword" class="col-sm-6 col-form-label">Domain(s) Interested </label>
                        <div class="col-sm-6">
                          <select multiple class="form-control" id="sel2" formControlName="domains">
                            <option [value]="domain?.id" *ngFor="let domain of domains; let i = index">{{domain?.title}}</option>
                          </select>
                        </div>
                      </div>
                    </div> -->

                    <div class="form-group row d-flex justify-content-center">
                      <button class="btn btnSave btn-sm" type="submit">Save</button>
                    </div>
                  </form>

                  <!-- <div class="card">
                  <div *ngIf="sendOtp" class="form-group row">
                    <label for="inputPassword" class=" col-sm-5 col-form-label">Contact Number </label>
                    <div class="col-sm-7">
                      <input type="text" [(ngModel)]="contactNumber" class="form-control" id="inputPassword"
                        placeholder="Enter your mobile number">
                    </div>
                  </div>
                 </div>
                 <div *ngIf="!sendOtp" class="card">
                  <div  class="form-group row">
                    <label for="inputPassword" class="col-sm-5 col-form-label">OTP </label>
                    <div class="col-sm-7">
                      <input type="text" [(ngModel)]="otp" class="form-control" id="inputPassword"
                        placeholder="Enter otp">
                    </div>
                  </div>
                 </div>
                  <div class="form-group row d-flex justify-content-center">
                    <button *ngIf="sendOtp" class="btn btnSave btn-sm" type="button" (click)="sendOtpToNumber()">Send Otp</button>
                    <button *ngIf="!sendOtp" class="btn btnSave btn-sm" type="button" (click)="saveNewContact()">Save Contact No.</button>
                  </div> -->
                </div>
              </div>
              <div class="tab-pane fade" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-profile-tab">
                <div>
                  <div class="card domainCard" *ngFor="let exam of myExams;">
                    <div><a href="javascript:void(0)"
                        routerLink="/assessment/dashboard/choose-p/{{exam?.exam?.id}}">{{exam?.exam?.title}}</a></div>
                    <div><a href="javascript:void(0)" (click)="setDeletionId(exam?.id)" data-toggle="modal"
                        data-target="#confirmationModal"><span class="iconify crossIconImage"
                          data-icon="fluent:delete-28-filled"></span></a></div>
                  </div>
                </div>
              </div>
              <div class="tab-pane fade" id="v-pills-messages" role="tabpanel" aria-labelledby="v-pills-messages-tab">
                <div class="changePasswordDiv newAndOldPAssword col-lg-8">
                  <!-- <h2>Now you can change your password.</h2> -->

                  <div class="form-group">
                    <label for="inputPassword" class="col-form-label">New Password : </label>
                    <input type="password" [(ngModel)]="password" name="password" class="form-control"
                      id="inputPassword">
                  </div>


                  <div class="form-group ">
                    <label for="inputPassword" class="col-form-label">Confirm New Password : </label>
                    <input type="password" [(ngModel)]="confirmPassword" name="confirmPassword" class="form-control"
                      id="inputPassword">
                  </div>

                  <div class="form-group row d-flex justify-content-center">
                    <button class="btn btnSave btn-sm" type="button" (click)="savePassword()">Save</button>
                  </div>
                </div>
              </div>
              <div class="tab-pane fade" id="v-pills-invitation" role="tabpanel"
                aria-labelledby="v-pills-invitation-tab">
                <div class="changePasswordDiv col-lg-10">
                  <!-- <h2>School Change Invitation</h2> -->

                  <div class="form-group row">
                    <label for="inputPassword" class="col-sm-4 col-form-label">New School : </label>
                    <div class="col-sm-8" *ngIf="invitation?.length > 0">
                      <input type="password" name="password" class="form-control" id="inputPassword"
                        placeholder="{{invitation[0].inviting_institute_room?.institute_name}}" disabled>
                    </div>
                  </div>

                  <!-- <div class="card">
                    <div class="form-group row">
                      <label for="inputPassword" class="col-sm-6 col-form-label">Confirm Password : </label>
                      <div class="col-sm-6">
                        <input type="password" [(ngModel)]="confirmPassword" name="confirmPassword" class= "form-control" id="inputPassword"
                          placeholder="Confirm Password">
                      </div>
                    </div>
                  </div> -->
                  <div class="form-group row d-flex justify-content-center">
                    <button class="btn btnSave btn-sm" type="button" data-toggle="modal"
                      data-target="#confirmationModalSchoolChange">Accept</button>
                  </div>
                </div>
              </div>
              <div class="tab-pane fade" id="v-pills-settings" role="tabpanel" aria-labelledby="v-pills-settings-tab">
                ...</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- <div class="mb-4 user-image d-flex justify-content-center">
      <div class="mx-auto">
        <div class="profile-img-container position-relative">
          <img src="{{ userImage ? userImage : env.DEFAULT_USER_PROFILE}}" alt="User Profile" class="user-img">
          <div class="customFileInput shadow" (click)="changeUserProfile(imageInput)">
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
        </div>
        <div *ngIf="userProfileObj" class="mt-4 text-center">
        </div>

        <input type="file" id="profilepic" (change)="upadateProfileImage()" class="inputfile" name="userImage" #imageInput>
       
      </div>
    </div>
    <div class="row formRow">
      <div class="col-md-6 offset-md-3 ">
        <form [formGroup]="profileForm" (submit)="onSubmit()">
          <div class="form-group">
            <label for="inputPassword" class="col-form-label">Full Name</label>
            <div class="">
              <input type="text" class="form-control" formControlName="fullname" id="inputPassword"
                placeholder="Enter your full name">
            </div>
          </div>
        
          <div class="form-group">
            <label for="inputPassword" class="col-form-label">State </label>
            <div class="">
              <select class="form-control" id="sel2" formControlName="state" (change)="fetchStateCities($event.target.value)">
                <option value="">Select State</option>
                <option [value]="state?.id" *ngFor="let state of states; let i = index">{{state?.name}}</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="inputPassword" class="col-form-label">City </label>
            <div class="">
              <select class="form-control" id="sel2" formControlName="city">
                <option value="">Select City</option>
                <option [value]="city?.id" *ngFor="let city of cities; let i = index">{{city?.name}}</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="inputPassword" class="col-form-label">Domain(s) Interested </label>
            <div class="">
              <select multiple class="form-control" id="sel2" formControlName="domains">
                <option [value]="domain?.id" *ngFor="let domain of domains; let i = index">{{domain?.title}}</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="inputPassword" class="col-form-label">Email Id </label>
            <div class="">
              <input type="email" formControlName="email" class="form-control" id="inputPassword"
                placeholder="Enter your email id">
            </div>
          </div>
          <div class="form-group">
            <label for="inputPassword" class="col-form-label">Qualification </label>
            <div class="">
              <select class="form-control" id="sel2" formControlName="qualification">
                <option value="">Select Qualification</option>
                <option value="10th">10th</option>
                <option value="12th">12th</option>
                <option value="graduation">Graduate</option>
                <option value="postgraduation">Post Graduate</option>
                <option value="other">Other</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="inputPassword" class="col-form-label">Gender </label>
            <div class="">
              <select class="form-control" id="sel2" formControlName="gender">
                <option value="">Select Gender</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="other">Other</option>
              </select>
            </div>
          </div>
          <div class="form-group row d-flex justify-content-center">
            <button class="btn btnSave btn-sm" type="submit">Save</button>
          </div>
        </form>
        <hr>
        <div *ngIf="sendOtp" class="form-group">
          <label for="inputPassword" class="col-form-label">Contact Number </label>
          <div class="">
            <input type="text" [(ngModel)]="contactNumber" class="form-control" id="inputPassword"
              placeholder="Enter your mobile number">
          </div>
        </div>
        <div *ngIf="!sendOtp" class="form-group">
          <label for="inputPassword" class="col-form-label">OTP </label>
          <div class="">
            <input type="text" [(ngModel)]="otp" class="form-control" id="inputPassword"
              placeholder="Enter otp">
          </div>
        </div>
        <div class="form-group row d-flex justify-content-center">
          <button *ngIf="sendOtp" class="btn btnSave btn-sm" type="button" (click)="sendOtpToNumber()">Send Otp</button>
          <button *ngIf="!sendOtp" class="btn btnSave btn-sm" type="button" (click)="saveNewContact()">Save Contact No.</button>
        </div>
      
      </div>
    </div>  -->
  </div>
</div>


<!-- Modal -->
<div class="modal fade confirmationModalmsg" id="confirmationModal" tabindex="-1" role="dialog"
  aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content" style="border-radius: 16px;border: none;">
      <div class="modal-header" style="border: none;">
        <h5 class="modal-title" id="confirmationModalLabel"
          style="font-size: 25px;font-weight: bold;color: #04607D;font-family: 'jaldi', sans-serif;">Confirmation</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p class="text-center" style="color: #544F4F; font-size: 16px;">Are you sure you want to remove this previous
          exam?</p>
      </div>
      <div class="modal-footer"
        style="background-color: #00A3F1; border-radius: 0 0 16px 16px;justify-content: space-between;">
        <button type="button" id="dimissModal" class="btn btn-sm btn-secondary" style="border-radius: 6px;"
          data-dismiss="modal" (click)="clearSelection()">Cancel</button>
        <button *ngIf="deletionExamId" type="button" class="btn btn-sm text-white"
          style="background-color: #FF4935; border-radius: 6px;" (click)="removeExam(deletionExamId)">Yes, delete it
          !</button>
        <button *ngIf="!deletionExamId" type="button" class="btn btn-sm text-white"
          style="background-color: #FF4935; border-radius: 6px;" (click)="removeAllExams()">Yes, delete it !</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade confirmationModalmsg" id="confirmationModalLogOut" tabindex="-1" role="dialog"
  aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content" style="border-radius: 16px;border: none;">
      <div class="modal-header" style="border: none;">
        <h5 class="modal-title" id="confirmationModalLabel"
          style="font-size: 25px;font-weight: bold;color: #04607D;font-family: 'jaldi', sans-serif;">Confirmation</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p class="text-center" style="color: #544F4F; font-size: 16px;">Are you sure you want to Logout?</p>
      </div>
      <div class="modal-footer"
        style="background-color: #00A3F1; border-radius: 0 0 16px 16px;justify-content: space-between;">
        <button type="button" id="dimissModal" class="btn btn-sm btn-secondary" style="border-radius: 6px;"
          data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-sm text-white" style="background-color: #FF4935; border-radius: 6px;"
          (click)="logout()">Logout !</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade confirmationModalmsg" id="confirmationModalSchoolChange" tabindex="-1" role="dialog"
  aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content" style="border-radius: 16px;border: none;">
      <div class="modal-header" style="border: none;">
        <h5 class="modal-title" id="confirmationModalLabel"
          style="font-size: 25px;font-weight: bold;color: #04607D;font-family: 'jaldi', sans-serif;">Confirmation</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" #closeModal>
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p class="text-center" style="color: #544F4F; font-size: 16px;">Are you sure you want to change your school?</p>
      </div>
      <div class="modal-footer"
        style="background-color: #00A3F1; border-radius: 0 0 16px 16px;justify-content: space-between;">
        <button type="button" id="dimissModal" class="btn btn-sm btn-secondary" style="border-radius: 6px;"
          data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-sm text-white" style="background-color: #FF4935; border-radius: 6px;"
          (click)="changeSchool()">Accept</button>
      </div>
    </div>
  </div>
</div>